<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>cr_lib: cr.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Defines</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<h1>cr.h File Reference</h1>  </div>
</div>
<div class="contents">
<code>#include &lt;setjmp.h&gt;</code><br/>
<code>#include &lt;stddef.h&gt;</code><br/>
<code>#include &lt;stdint.h&gt;</code><br/>
<code>#include &lt;stdbool.h&gt;</code><br/>
<code>#include &lt;fenv.h&gt;</code><br/>
<code>#include &lt;assert.h&gt;</code><br/>
<div class="dynheader">
Include dependency graph for cr.h:</div>
<div class="dyncontent">
<div class="center"><img src="cr_8h__incl.png" border="0" usemap="#cr_8h" alt=""/></div>
<map name="cr_8h" id="cr_8h">
</map>
</div>
<div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="cr_8h__dep__incl.png" border="0" usemap="#cr_8hdep" alt=""/></div>
<map name="cr_8hdep" id="cr_8hdep">
</map>
</div>

<p><a href="cr_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_c_r___c_o_n_t_e_x_t.html">CR_CONTEXT</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Coroutine context information.  <a href="struct_c_r___c_o_n_t_e_x_t.html#_details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cr_8h.html#ac68ef77f5ea5f5dda5a2f046a2c96429">CR_THREAD_INIT</a>()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initializes a function as a coroutine.  <a href="#ac68ef77f5ea5f5dda5a2f046a2c96429"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cr_8h.html#ad89b832374912ca6c097b550a95a8ebf">CR_START</a>(func_name)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Starts the cr_lib system.  <a href="#ad89b832374912ca6c097b550a95a8ebf"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cr_8h.html#a18adb578c9437579bc39134852d4fc5b">CR_YIELD</a>(func_name)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Explicitly yields to a coroutine.  <a href="#a18adb578c9437579bc39134852d4fc5b"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef int8_t volatile&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cr_8h.html#aa058fade3e44aea5c2098896835e47fc">cr_int8_t</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Coroutine variable typedefs.  <a href="#aa058fade3e44aea5c2098896835e47fc"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a73f142aa6006115a8412684a32dd577e"></a><!-- doxytag: member="cr.h::cr_uint8_t" ref="a73f142aa6006115a8412684a32dd577e" args="" -->
typedef uint8_t volatile&nbsp;</td><td class="memItemRight" valign="bottom"><b>cr_uint8_t</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac5ed048ec745ff236a340b1c264abbe0"></a><!-- doxytag: member="cr.h::cr_int16_t" ref="ac5ed048ec745ff236a340b1c264abbe0" args="" -->
typedef int16_t volatile&nbsp;</td><td class="memItemRight" valign="bottom"><b>cr_int16_t</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a45f5bcd89871c409b2672e1c905fd47c"></a><!-- doxytag: member="cr.h::cr_uint16_t" ref="a45f5bcd89871c409b2672e1c905fd47c" args="" -->
typedef uint16_t volatile&nbsp;</td><td class="memItemRight" valign="bottom"><b>cr_uint16_t</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0513e6e6438b6d5c05a75d3585499747"></a><!-- doxytag: member="cr.h::cr_int32_t" ref="a0513e6e6438b6d5c05a75d3585499747" args="" -->
typedef int32_t volatile&nbsp;</td><td class="memItemRight" valign="bottom"><b>cr_int32_t</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a70e19850a31b4ddf93cbfac80d8f5596"></a><!-- doxytag: member="cr.h::cr_uint32_t" ref="a70e19850a31b4ddf93cbfac80d8f5596" args="" -->
typedef uint32_t volatile&nbsp;</td><td class="memItemRight" valign="bottom"><b>cr_uint32_t</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a81aabf8e7ff2cc78c58b0791f0b015e5"></a><!-- doxytag: member="cr.h::cr_int64_t" ref="a81aabf8e7ff2cc78c58b0791f0b015e5" args="" -->
typedef int64_t volatile&nbsp;</td><td class="memItemRight" valign="bottom"><b>cr_int64_t</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a00b44f3e0d6d8337340687b83d6603e5"></a><!-- doxytag: member="cr.h::cr_uint64_t" ref="a00b44f3e0d6d8337340687b83d6603e5" args="" -->
typedef uint64_t volatile&nbsp;</td><td class="memItemRight" valign="bottom"><b>cr_uint64_t</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef int32_t volatile&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cr_8h.html#ae9a0f05a9df6e08a47e828db183fa186">cr_id_t</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Coroutine ID typedef.  <a href="#ae9a0f05a9df6e08a47e828db183fa186"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct_c_r___c_o_n_t_e_x_t.html">CR_CONTEXT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cr_8h.html#a22d1195c5636aed1fc8a4bdd7ade60f5">CR_CONTEXT</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Coroutine context information.  <a href="#a22d1195c5636aed1fc8a4bdd7ade60f5"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom">{ <br/>
&nbsp;&nbsp;<a class="el" href="cr_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a7f396d7461f79cb150ed6b69934f58ec">SETJMP_DFLT_RET_VAL</a> =  1, 
<a class="el" href="cr_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a60cd04d936d5d89f7468cf9f5240a487">CR_IDLE_THREAD_ID</a> =  0, 
<a class="el" href="cr_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a01288475e3cc36707461f9b757d00e74">CR_SYSTEM_STARTED</a> =  -1, 
<a class="el" href="cr_8h.html#adf764cbdea00d65edcd07bb9953ad2b7acd063e5de520275d94952e07b5f29b18">CR_INVALID_ID</a> =  -1, 
<br/>
&nbsp;&nbsp;<a class="el" href="cr_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a139db075566e7ab9f59a9de7f6d2359f">CR_THREAD_CNT_INIT</a> =  -1
<br/>
 }</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Annonymous enumerations that define various states and settings. </p>
 <a href="cr_8h.html#adf764cbdea00d65edcd07bb9953ad2b7">More...</a><br/></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cr_8h.html#a3e8d6963f6ee2cc49502186eca21d879">cr_reset</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Resets the system to an initial state.  <a href="#a3e8d6963f6ee2cc49502186eca21d879"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cr_8h.html#aca6b87323f9ce0bf21b3f06209a97989">cr_init</a> (<a class="el" href="struct_c_r___c_o_n_t_e_x_t.html">CR_CONTEXT</a> *cr_context, size_t cr_context_count)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">cr_lib's initialization function.  <a href="#aca6b87323f9ce0bf21b3f06209a97989"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="cr_8h.html#ae9a0f05a9df6e08a47e828db183fa186">cr_id_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cr_8h.html#a3e7a31163658d81c9473e5b637d9eb90">cr_get_id</a> (void(*pFunc)(void))</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Find the ID of a coroutine.  <a href="#a3e7a31163658d81c9473e5b637d9eb90"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cr_8h.html#accd73b48023970380bfdecb56483976c">cr_idle</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The internal system's coroutine thread.  <a href="#accd73b48023970380bfdecb56483976c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="cr_8h.html#ae9a0f05a9df6e08a47e828db183fa186">cr_id_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cr_8h.html#ae30bdb4ef569c0678e4cb49829f11bbb">cr_register_thread</a> (void(*pFunc)(void))</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Register a function as a coroutine thread.  <a href="#ae30bdb4ef569c0678e4cb49829f11bbb"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_c_r___c_o_n_t_e_x_t.html">CR_CONTEXT</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cr_8h.html#a22841ff791649abd0bcb62392ebb9778">cr_g_context</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pointer to the user defined array of coroutine contexts.  <a href="#a22841ff791649abd0bcb62392ebb9778"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cr_8h.html#a8238e77b653b2cc4905373b805fc3567">cr_g_context_cnt</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The number of elements in the coroutine context array.  <a href="#a8238e77b653b2cc4905373b805fc3567"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cr_8h.html#a00999e3368c59592db0c069abf1f1296">cr_g_sys_started</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Flag that's set when CR_START is called.  <a href="#a00999e3368c59592db0c069abf1f1296"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="cr_8h.html#ae9a0f05a9df6e08a47e828db183fa186">cr_id_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cr_8h.html#ae7e93574baec3ae2b083c7f36916fbbd">cr_g_previous_cr_id</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The ID of the previously active coroutine.  <a href="#ae7e93574baec3ae2b083c7f36916fbbd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="cr_8h.html#ae9a0f05a9df6e08a47e828db183fa186">cr_id_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cr_8h.html#acf4ab64c8de56045d84e53b65dba7eb8">cr_g_current_cr_id</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The ID of the coroutine that's active.  <a href="#acf4ab64c8de56045d84e53b65dba7eb8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1374fdc17d74ee4b6e94c63251886ea3"></a><!-- doxytag: member="cr.h::cr_g_reg_func_env" ref="a1374fdc17d74ee4b6e94c63251886ea3" args="" -->
jmp_buf&nbsp;</td><td class="memItemRight" valign="bottom"><b>cr_g_reg_func_env</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1345c6db4d2d1d939e7841da46704d8e"></a><!-- doxytag: member="cr.h::cr_g_activate_id" ref="a1345c6db4d2d1d939e7841da46704d8e" args="" -->
<a class="el" href="cr_8h.html#ae9a0f05a9df6e08a47e828db183fa186">cr_id_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cr_8h.html#a1345c6db4d2d1d939e7841da46704d8e">cr_g_activate_id</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Holds the ID of the coroutine to be activated - by cr_idle. <br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<dl class="author"><dt><b>Author:</b></dt><dd>Original author : Joseph D Poirier </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>Creation date : February 2006</dd></dl>
<dl class="version"><dt><b>Version:</b></dt><dd>X.X.X</dd></dl>
<p>VERSION DATE/AUTHOR COMMENT</p>
<p>LICENSE: see the license.txt file </p>

<p>Definition in file <a class="el" href="cr_8h_source.html">cr.h</a>.</p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="ad89b832374912ca6c097b550a95a8ebf"></a><!-- doxytag: member="cr.h::CR_START" ref="ad89b832374912ca6c097b550a95a8ebf" args="(func_name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CR_START</td>
          <td>(</td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">func_name</td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Starts the cr_lib system. </p>
<p>This macro basically boostraps the system. Bootstrap the system by fetching the ID of the coroutine to call and call it.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>func_name</em>&nbsp;</td><td>the name of a user coroutine or cr_idle</td></tr>
  </table>
  </dd>
</dl>
<dl class="attention"><dt><b>Attention:</b></dt><dd>cr_init must have been called and coroutine registration completed </dd></dl>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="demo__1_8c-example.html#a6">demo_1.c</a>, <a class="el" href="demo__2_8c-example.html#a10">demo_2.c</a>, <a class="el" href="demo__3_8c-example.html#a6">demo_3.c</a>, and <a class="el" href="demo__4_8c-example.html#a12">demo_4.c</a>.</dd>
</dl>
<p>Definition at line <a class="el" href="cr_8h_source.html#l00108">108</a> of file <a class="el" href="cr_8h_source.html">cr.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac68ef77f5ea5f5dda5a2f046a2c96429"></a><!-- doxytag: member="cr.h::CR_THREAD_INIT" ref="ac68ef77f5ea5f5dda5a2f046a2c96429" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CR_THREAD_INIT</td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initializes a function as a coroutine. </p>
<p>This macro creates the static variable this_id__ which holds the ID of the newly created coroutine. cr_g_current_cr_id is used by cr_register_thread to pass the newly assigned coroutine ID to the function being registered. The ID is then used to save the new coroutine's context, which serves as the initial entry point in to the coroutine. Rather than returning normally, a longjmp is performed to get back to the cr_register_thread function.</p>
<dl class="attention"><dt><b>Attention:</b></dt><dd>This macro should be placed at the start of the function being registered as a coroutine. Also, a coroutine should never return normally. </dd></dl>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="demo__1_8c-example.html#a0">demo_1.c</a>, <a class="el" href="demo__2_8c-example.html#a0">demo_2.c</a>, <a class="el" href="demo__3_8c-example.html#a0">demo_3.c</a>, and <a class="el" href="demo__4_8c-example.html#a5">demo_4.c</a>.</dd>
</dl>
<p>Definition at line <a class="el" href="cr_8h_source.html#l00090">90</a> of file <a class="el" href="cr_8h_source.html">cr.h</a>.</p>

</div>
</div>
<a class="anchor" id="a18adb578c9437579bc39134852d4fc5b"></a><!-- doxytag: member="cr.h::CR_YIELD" ref="a18adb578c9437579bc39134852d4fc5b" args="(func_name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CR_YIELD</td>
          <td>(</td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">func_name</td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Explicitly yields to a coroutine. </p>
<p>This macro fetches the ID of the coroutine to be called, sets the current environment, then makes a longjmp to the desired coroutine.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>func_name</em>&nbsp;</td><td>the name of a user coroutine or cr_idle </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="demo__1_8c-example.html#a1">demo_1.c</a>, <a class="el" href="demo__2_8c-example.html#a4">demo_2.c</a>, <a class="el" href="demo__3_8c-example.html#a1">demo_3.c</a>, and <a class="el" href="demo__4_8c-example.html#a6">demo_4.c</a>.</dd>
</dl>
<p>Definition at line <a class="el" href="cr_8h_source.html#l00124">124</a> of file <a class="el" href="cr_8h_source.html">cr.h</a>.</p>

</div>
</div>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="a22d1195c5636aed1fc8a4bdd7ade60f5"></a><!-- doxytag: member="cr.h::CR_CONTEXT" ref="a22d1195c5636aed1fc8a4bdd7ade60f5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct_c_r___c_o_n_t_e_x_t.html">CR_CONTEXT</a>  <a class="el" href="struct_c_r___c_o_n_t_e_x_t.html">CR_CONTEXT</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Coroutine context information. </p>
<p>A pointer to an array of this structure type is passed to the cr_init function.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>The context array _must_ include 1 extra element for the system's cr_idle coroutine. </dd></dl>

</div>
</div>
<a class="anchor" id="ae9a0f05a9df6e08a47e828db183fa186"></a><!-- doxytag: member="cr.h::cr_id_t" ref="ae9a0f05a9df6e08a47e828db183fa186" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int32_t volatile <a class="el" href="cr_8h.html#ae9a0f05a9df6e08a47e828db183fa186">cr_id_t</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Coroutine ID typedef. </p>
<p>Coroutine ID type used by the cr_lib system. </p>

<p>Definition at line <a class="el" href="cr_8h_source.html#l00063">63</a> of file <a class="el" href="cr_8h_source.html">cr.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa058fade3e44aea5c2098896835e47fc"></a><!-- doxytag: member="cr.h::cr_int8_t" ref="aa058fade3e44aea5c2098896835e47fc" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int8_t volatile <a class="el" href="cr_8h.html#aa058fade3e44aea5c2098896835e47fc">cr_int8_t</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Coroutine variable typedefs. </p>
<p>Some convenience typdefs for defining local thread variables.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>Local types _should_ include the volatile qualifier. </dd></dl>

<p>Definition at line <a class="el" href="cr_8h_source.html#l00038">38</a> of file <a class="el" href="cr_8h_source.html">cr.h</a>.</p>

</div>
</div>
<hr/><h2>Enumeration Type Documentation</h2>
<a class="anchor" id="adf764cbdea00d65edcd07bb9953ad2b7"></a><!-- doxytag: member="cr.h::@1" ref="adf764cbdea00d65edcd07bb9953ad2b7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Annonymous enumerations that define various states and settings. </p>
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="adf764cbdea00d65edcd07bb9953ad2b7a7f396d7461f79cb150ed6b69934f58ec"></a><!-- doxytag: member="SETJMP_DFLT_RET_VAL" ref="adf764cbdea00d65edcd07bb9953ad2b7a7f396d7461f79cb150ed6b69934f58ec" args="" -->SETJMP_DFLT_RET_VAL</em>&nbsp;</td><td>
<p>longjmp's required second paramter, which is setjmp's return value </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="adf764cbdea00d65edcd07bb9953ad2b7a60cd04d936d5d89f7468cf9f5240a487"></a><!-- doxytag: member="CR_IDLE_THREAD_ID" ref="adf764cbdea00d65edcd07bb9953ad2b7a60cd04d936d5d89f7468cf9f5240a487" args="" -->CR_IDLE_THREAD_ID</em>&nbsp;</td><td>
<p>ID of the system's cr_idle coroutine </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="adf764cbdea00d65edcd07bb9953ad2b7a01288475e3cc36707461f9b757d00e74"></a><!-- doxytag: member="CR_SYSTEM_STARTED" ref="adf764cbdea00d65edcd07bb9953ad2b7a01288475e3cc36707461f9b757d00e74" args="" -->CR_SYSTEM_STARTED</em>&nbsp;</td><td>
<p>Sentinal flag used internally </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="adf764cbdea00d65edcd07bb9953ad2b7acd063e5de520275d94952e07b5f29b18"></a><!-- doxytag: member="CR_INVALID_ID" ref="adf764cbdea00d65edcd07bb9953ad2b7acd063e5de520275d94952e07b5f29b18" args="" -->CR_INVALID_ID</em>&nbsp;</td><td>
<p>Returned by cr_get_id when an ID is not found </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="adf764cbdea00d65edcd07bb9953ad2b7a139db075566e7ab9f59a9de7f6d2359f"></a><!-- doxytag: member="CR_THREAD_CNT_INIT" ref="adf764cbdea00d65edcd07bb9953ad2b7a139db075566e7ab9f59a9de7f6d2359f" args="" -->CR_THREAD_CNT_INIT</em>&nbsp;</td><td>
<p>Internal initialization value </p>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="cr_8h_source.html#l00050">50</a> of file <a class="el" href="cr_8h_source.html">cr.h</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a3e7a31163658d81c9473e5b637d9eb90"></a><!-- doxytag: member="cr.h::cr_get_id" ref="a3e7a31163658d81c9473e5b637d9eb90" args="(void(*pFunc)(void))" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cr_8h.html#ae9a0f05a9df6e08a47e828db183fa186">cr_id_t</a> cr_get_id </td>
          <td>(</td>
          <td class="paramtype">void(*)(void)&nbsp;</td>
          <td class="paramname"> <em>pFunc</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Find the ID of a coroutine. </p>
<p>Returns the ID of a registered coroutine.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pFunc</em>&nbsp;</td><td>the registered coroutine whose ID is requested </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>CR_INVALID_ID</em>&nbsp;</td><td>when no ID is found </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>id</em>&nbsp;</td><td>a valid coroutine's ID </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="cr_8c_source.html#l00198">198</a> of file <a class="el" href="cr_8c_source.html">cr.c</a>.</p>

</div>
</div>
<a class="anchor" id="accd73b48023970380bfdecb56483976c"></a><!-- doxytag: member="cr.h::cr_idle" ref="accd73b48023970380bfdecb56483976c" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cr_idle </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The internal system's coroutine thread. </p>
<p>This coroutine thread is used in conjunction with the cr_g_activate_id variable. cr_g_activate_id can be set to a coroutine's ID, e.g. in an ISR handler, and this function will activate the coroutine. This will work only if this function is explicitly called via CR_YIELD.</p>
<dl class="attention"><dt><b>Attention:</b></dt><dd>This coroutine thread must be explicitly called for it to run. </dd></dl>

<p>Definition at line <a class="el" href="cr_8c_source.html#l00261">261</a> of file <a class="el" href="cr_8c_source.html">cr.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cr_8h_accd73b48023970380bfdecb56483976c_icgraph.png" border="0" usemap="#cr_8h_accd73b48023970380bfdecb56483976c_icgraph" alt=""/></div>
<map name="cr_8h_accd73b48023970380bfdecb56483976c_icgraph" id="cr_8h_accd73b48023970380bfdecb56483976c_icgraph">
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aca6b87323f9ce0bf21b3f06209a97989"></a><!-- doxytag: member="cr.h::cr_init" ref="aca6b87323f9ce0bf21b3f06209a97989" args="(CR_CONTEXT *cr_context, size_t cr_context_count)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cr_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_c_r___c_o_n_t_e_x_t.html">CR_CONTEXT</a> *&nbsp;</td>
          <td class="paramname"> <em>cr_context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>cr_context_count</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>cr_lib's initialization function. </p>
<p>This function sets a global pointer to the array holding all of the registered coroutines context information, as well as, the element count of the array.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>cr_context</em>&nbsp;</td><td>the context array </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cr_context_count</em>&nbsp;</td><td>the element count of the array </td></tr>
  </table>
  </dd>
</dl>
<dl class="attention"><dt><b>Attention:</b></dt><dd>This initialization function must be the first function called in the library. </dd></dl>

<p>Definition at line <a class="el" href="cr_8c_source.html#l00238">238</a> of file <a class="el" href="cr_8c_source.html">cr.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cr_8h_aca6b87323f9ce0bf21b3f06209a97989_cgraph.png" border="0" usemap="#cr_8h_aca6b87323f9ce0bf21b3f06209a97989_cgraph" alt=""/></div>
<map name="cr_8h_aca6b87323f9ce0bf21b3f06209a97989_cgraph" id="cr_8h_aca6b87323f9ce0bf21b3f06209a97989_cgraph">
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae30bdb4ef569c0678e4cb49829f11bbb"></a><!-- doxytag: member="cr.h::cr_register_thread" ref="ae30bdb4ef569c0678e4cb49829f11bbb" args="(void(*pFunc)(void))" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cr_8h.html#ae9a0f05a9df6e08a47e828db183fa186">cr_id_t</a> cr_register_thread </td>
          <td>(</td>
          <td class="paramtype">void(*)(void)&nbsp;</td>
          <td class="paramname"> <em>pFunc</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Register a function as a coroutine thread. </p>
<p>This function creates an ID for the new coroutine thread and associates the ID with a context element. Information about the coroutine is set in the context element. cr_g_current_cr_id is set to the new coroutine's ID. The cr_register_thread function's context is saved and the user function is called. The CR_THREAD_INIT macro performs a longjmp back to this function using the previously saved context. The cr_g_sys_started flag is checked to determine if a user coroutine has exited via the function's epilog code.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pFunc</em>&nbsp;</td><td>the function to be registered </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The ID of the registered coroutine. </dd></dl>
<dl class="attention"><dt><b>Attention:</b></dt><dd>All coroutine thread registration must be completed before calling CR_START. </dd></dl>

<p>Definition at line <a class="el" href="cr_8c_source.html#l00307">307</a> of file <a class="el" href="cr_8c_source.html">cr.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cr_8h_ae30bdb4ef569c0678e4cb49829f11bbb_cgraph.png" border="0" usemap="#cr_8h_ae30bdb4ef569c0678e4cb49829f11bbb_cgraph" alt=""/></div>
<map name="cr_8h_ae30bdb4ef569c0678e4cb49829f11bbb_cgraph" id="cr_8h_ae30bdb4ef569c0678e4cb49829f11bbb_cgraph">
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cr_8h_ae30bdb4ef569c0678e4cb49829f11bbb_icgraph.png" border="0" usemap="#cr_8h_ae30bdb4ef569c0678e4cb49829f11bbb_icgraph" alt=""/></div>
<map name="cr_8h_ae30bdb4ef569c0678e4cb49829f11bbb_icgraph" id="cr_8h_ae30bdb4ef569c0678e4cb49829f11bbb_icgraph">
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3e8d6963f6ee2cc49502186eca21d879"></a><!-- doxytag: member="cr.h::cr_reset" ref="a3e8d6963f6ee2cc49502186eca21d879" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cr_reset </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Resets the system to an initial state. </p>
<p>This function sets all the system's global variables to their original state. </p>

<p>Definition at line <a class="el" href="cr_8c_source.html#l00219">219</a> of file <a class="el" href="cr_8c_source.html">cr.c</a>.</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a22841ff791649abd0bcb62392ebb9778"></a><!-- doxytag: member="cr.h::cr_g_context" ref="a22841ff791649abd0bcb62392ebb9778" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_c_r___c_o_n_t_e_x_t.html">CR_CONTEXT</a>* <a class="el" href="cr_8h.html#a22841ff791649abd0bcb62392ebb9778">cr_g_context</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Pointer to the user defined array of coroutine contexts. </p>
<dl class="note"><dt><b>Note:</b></dt><dd>For internal use only. </dd></dl>

<p>Definition at line <a class="el" href="cr_8c_source.html#l00159">159</a> of file <a class="el" href="cr_8c_source.html">cr.c</a>.</p>

</div>
</div>
<a class="anchor" id="a8238e77b653b2cc4905373b805fc3567"></a><!-- doxytag: member="cr.h::cr_g_context_cnt" ref="a8238e77b653b2cc4905373b805fc3567" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t <a class="el" href="cr_8h.html#a8238e77b653b2cc4905373b805fc3567">cr_g_context_cnt</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The number of elements in the coroutine context array. </p>
<dl class="note"><dt><b>Note:</b></dt><dd>For internal use only. </dd></dl>

<p>Definition at line <a class="el" href="cr_8c_source.html#l00164">164</a> of file <a class="el" href="cr_8c_source.html">cr.c</a>.</p>

</div>
</div>
<a class="anchor" id="acf4ab64c8de56045d84e53b65dba7eb8"></a><!-- doxytag: member="cr.h::cr_g_current_cr_id" ref="acf4ab64c8de56045d84e53b65dba7eb8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cr_8h.html#ae9a0f05a9df6e08a47e828db183fa186">cr_id_t</a> <a class="el" href="cr_8h.html#acf4ab64c8de56045d84e53b65dba7eb8">cr_g_current_cr_id</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The ID of the coroutine that's active. </p>
<dl class="note"><dt><b>Note:</b></dt><dd>For internal use only. </dd></dl>

<p>Definition at line <a class="el" href="cr_8c_source.html#l00178">178</a> of file <a class="el" href="cr_8c_source.html">cr.c</a>.</p>

</div>
</div>
<a class="anchor" id="ae7e93574baec3ae2b083c7f36916fbbd"></a><!-- doxytag: member="cr.h::cr_g_previous_cr_id" ref="ae7e93574baec3ae2b083c7f36916fbbd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cr_8h.html#ae9a0f05a9df6e08a47e828db183fa186">cr_id_t</a> <a class="el" href="cr_8h.html#ae7e93574baec3ae2b083c7f36916fbbd">cr_g_previous_cr_id</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The ID of the previously active coroutine. </p>
<dl class="note"><dt><b>Note:</b></dt><dd>For internal use only. </dd></dl>

<p>Definition at line <a class="el" href="cr_8c_source.html#l00183">183</a> of file <a class="el" href="cr_8c_source.html">cr.c</a>.</p>

</div>
</div>
<a class="anchor" id="a00999e3368c59592db0c069abf1f1296"></a><!-- doxytag: member="cr.h::cr_g_sys_started" ref="a00999e3368c59592db0c069abf1f1296" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t <a class="el" href="cr_8h.html#a00999e3368c59592db0c069abf1f1296">cr_g_sys_started</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Flag that's set when CR_START is called. </p>
<dl class="note"><dt><b>Note:</b></dt><dd>For internal use only. </dd></dl>

<p>Definition at line <a class="el" href="cr_8c_source.html#l00173">173</a> of file <a class="el" href="cr_8c_source.html">cr.c</a>.</p>

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Fri Jun 25 2010 10:41:01 for cr_lib by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
